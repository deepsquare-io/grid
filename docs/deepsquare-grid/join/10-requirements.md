# Requirements

In order to be eligible for the DeepSquare Grid, a cluster needs to meet some requirements:

## **Control plane requirements**

The control plane can be easily deployed by using [**ClusterFactory**](https://clusterfactory.io/), which is our open source cluster manager available on [github](https://github.com/deepsquare-io/ClusterFactory).
[**ClusterFactory**](https://clusterfactory.io/) makes the process of deploying a full fledged HPC cluster and joining the grid fast and easy.

| Minimum Requirements                                                                                                                                                                               | Recommended                                                                                                                                                                                                                                                                  |
| -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| A LDAP server                                                                                                                                                                                      | Docker: [389ds/dirsrv](https://hub.docker.com/r/389ds/dirsrv)                                                                                                                                                                                                                |
| The [LDAP connector](https://github.com/deepsquare-io/the-grid/tree/main/ldap-connector)                                                                                                           | Docker: <pre>ghcr.io/deepsquare-io/ldap-connector:latest</pre>                                                                                                                                                                                                               |
| A SLURM login node, SLURM database with MySQL and SLURM controller with the [provider SLURM completion plugin](https://github.com/deepsquare-io/the-grid/tree/main/provider-job-completion-plugin) | Docker: [<br /><pre>ghcr.io/squarefactory/slurm:&lt;version&gt;-login-rocky8.6<br />ghcr.io/squarefactory/slurm:&lt;version&gt;-controller-rocky8.6<br />ghcr.io/squarefactory/slurm:&lt;version&gt;-db-rocky8.6<br /></pre>](https://github.com/SquareFactory/slurm-docker) |
| MySQL server                                                                                                                                                                                       | Docker: [<pre>bitnami/mariadb</pre>](https://hub.docker.com/r/bitnami/mariadb)                                                                                                                                                                                               |
| A network shared filesystem server                                                                                                                                                                 | [BeeGFS](https://www.beegfs.io/) or any shared file system with RDMA                                                                                                                                                                                                         |
| A DNS server                                                                                                                                                                                       | Any                                                                                                                                                                                                                                                                          |
| [CVMFS](https://cernvm.cern.ch/fs/) stratum 1                                                                                                                                                      | Docker: [<pre>ghcr.io/squarefactory/cvmfs-server:latest</pre>](https://github.com/SquareFactory/cvmfs-server-docker)                                                                                                                                                         |
| [The DeepSquare Supervisor](https://github.com/deepsquare-io/the-grid/tree/main/supervisor)                                                                                                        | Docker: [<pre>ghcr.io/deepsquare-io/supervisor:latest</pre>](https://github.com/deepsquare-io/the-grid/tree/main/supervisor)                                                                                                                                                 |

## **Compute plane requirements**

We recommend that you boot your operating systems as [live images](https://man7.org/linux/man-pages/man7/dracut.cmdline.7.html#:~:text=0.0.0600%2C0.0.0601%2Cprotocol%3Dbar-,Booting%20live%20images,-Dracut%20offers%20multiple).

Most of the requirements can be met by using the **[grendel provisioner](https://docs.clusterfactory.io/docs/main-concepts/apps/grendel)** of [**ClusterFactory**](https://clusterfactory.io/).

| Minimum Requirements                                                                                                                                                                                       | Recommended                                                                                                                                                                                                                                                                                                                                                                                               |
| ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| An x86_64 OS with the Linux Kernel                                                                                                                                                                         | SquareOS ([qcow2](https://sos-ch-dk-2.exo.io/osimages/squareos-8.6/squareos-8.6.qcow)/[squashfs](https://sos-ch-dk-2.exo.io/osimages/squareos-8.6/squareos-8.6.squashfs)), [initramfs setup for live image](https://sos-ch-dk-2.exo.io/osimages/squareos-8.6/initramfs-4.18.0-372.19.1.el8_6.x86_64.img), [kernel](https://sos-ch-dk-2.exo.io/osimages/squareos-8.6/vmlinuz-4.18.0-372.19.1.el8_6.x86_64) |
| [SLURM](https://slurm.schedmd.com/overview.html) with [Pyxis](https://github.com/NVIDIA/pyxis) and the [provider](https://github.com/deepsquare-io/the-grid/tree/main/provider-spank-plugin) SPANK plugins | (already pre-installed on SquareOS)<br />From the deepsquare YUM repository.<br /><pre>dnf config-manager --add-repo https://yum.deepsquare.run/yum.repo<br />dnf install -y pmix4 slurm-contribs slurm-libpmi slurm-pam_slurm slurm-slurmd nvslurm-plugin-pyxis spank-provider</pre>                                                                                                                     |
| Nvidia GPUs                                                                                                                                                                                                | (drivers already pre-installed on SquareOS)<br />                                                                                                                                                                                                                                                                                                                                                         |
| The container runtimes [Enroot](https://github.com/NVIDIA/enroot) and [Apptainer](https://apptainer.org/)                                                                                                  | (already pre-installed on SquareOS)<br />From the deepsquare YUM repository.<br /><pre>dnf config-manager --add-repo https://yum.deepsquare.run/yum.repo<br />dnf install -y enroot-hardened enroot-hardened+caps apptainer</pre>                                                                                                                                                                         |
| An interconnect for all the compute nodes and storage nodes                                                                                                                                                | (drivers already pre-installed on SquareOS)<br />Infiniband or Ethernet with RDMA (At least 100Gbps)                                                                                                                                                                                                                                                                                                      |
| A network shared filesystem client                                                                                                                                                                         | (client already pre-installed on SquareOS)<br />[BeeGFS](https://www.beegfs.io/) or any shared file system with RDMA.                                                                                                                                                                                                                                                                                     |
| Necessary [postscripts](https://github.com/deepsquare-io/postscripts)                                                                                                                                      |                                                                                                                                                                                                                                                                                                                                                                                                           |

## Network configuration

The control plane and compute place must share the same subnet.

No port is needed to be opened since the supervisor is using a pull-based strategy to fetch jobs.
