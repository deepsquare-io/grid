---
job:
  enableLogging: true
  env:
    - key: DISPLAY
      value: ':99'
    - key: XDG_RUNTIME_DIR
      value: '/tmp'
  resources:
    tasks: 1
    cpusPerTask: 4
    memPerCpu: 4096
    gpusPerTask: 1
  input:
    http:
      url: https://transfer.sh/pEfPqI/DPSBeta.zip
  inputMode: 493
  steps:
    - name: urs
      run:
        x11: true
        image: '/data/beegfs/localhost+tdp+latest.sqsh'
        resources:
          tasks: 1
          cpusPerTask: 4
          memPerCpu: 4096
          gpusPerTask: 1
        command: |-
          $DEEPSQUARE_INPUT/DeepSquareURSSample.x86_64 \
            -maxplayers 8 \
            -webserverurl 'wss://tdp.deepsquare.run' \
            -renderfps 60 \
            -streamfps 30 \
            -sessionpin 123 \
            -minbitrate 10000 \
            -maxbitrate 50000 \
            -adaptativeupscaling \
            -minimumrenderscale 0.5 \
            -renderscalestepcount 0.1 \
            -displayfpscounter \
            --logFile -


  {
    "enableLogging": true,
    "env": [
      {
        "key": "DISPLAY",
        "value": ":99"
      },
      {
        "key": "XDG_RUNTIME_DIR",
        "value": "/tmp"
      }
    ],
    "resources": {
      "tasks": 1,
      "cpusPerTask": 4,
      "memPerCpu": 1024,
      "gpusPerTask": 1
    },
    "steps": [
      {
        "name": "tdp",
        "run": {
          "x11": true,
          "image": "/data/beegfs/localhost+tdp+latest.sqsh",
          "resources": {
            "tasks": 1,
            "cpusPerTask": 4,
            "memPerCpu": 4096,
            "gpusPerTask": 1
          },
          "command": "|-\n                    /unityapp/DeepSquareURSSample.x86_64                       -maxplayers 8 -webserverurl 'wss://tdp.deepsquare.run'                       -renderfps 60                       -streamfps 30                       -sessionpin 123                       -minbitrate 10000                       -maxbitrate 50000                                             -minimumrenderscale 0.5                       -renderscalestepcount 0.1                       -displayfpscounter                       --logFile -"
        }
      }
    ]
  }